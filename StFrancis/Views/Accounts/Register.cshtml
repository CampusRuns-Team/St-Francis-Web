@model StFrancis.ViewModel.RegisterVm
@{
    ViewData["Title"] = "Register";
    Layout = "~/Views/Shared/_AccountLayout.cshtml";
}
@section Css{
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css">

    <link href="~/css/Form.css" rel="stylesheet" />

}





    <div id="saved-home-main" class="container-fluid" style="margin-bottom: 90px;  margin-top: 50px;">



        <div class="row justify-content-center">
            <div class="col-11 col-sm-10 col-md-10 col-lg-6 col-xl-8 text-center p-0 mt-3 mb-2">
            
                    <h2 id="heading">Parishioner Signup Form</h2>
                    <p>Fill all form field to go to next step</p>
                    <form id="msform">
                        <!-- progressbar -->
                        <ul id="progressbar">
                            <li class="active" id="account"><strong>Account</strong></li>
                            <li id="personal"><strong>Personal</strong></li>
                            <li id="payment"><strong>Image</strong></li>
                            <li id="confirm"><strong>Finish</strong></li>
                        </ul>
                        <div class="progress">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
                        </div> <br> <!-- fieldsets -->
                        <fieldset>
                            <div class="form-card">
                                <div class="row">
                                    <div class="col-7">
                                        <h2 class="fs-title">Account Information:</h2>
                                    </div>
                                    <div class="col-5">
                                        <h2 class="steps">Step 1 - 4</h2>
                                    </div>
                                </div> 
                                <div class="row">
                                    <div class="col-6">
                                        <label class="fieldlabels">Email: *</label> <input type="email" name="email" placeholder="Email Id" />
                                    </div>
                                    <div class="col-6">
                                        <label class="fieldlabels">Username: *</label> <input type="text" name="uname" placeholder="UserName" />
                                    </div>
                                </div>
                             <label class="fieldlabels">Password: *</label> <input type="password" name="pwd" placeholder="Password" /> <label class="fieldlabels">Confirm Password: *</label> <input type="password" name="cpwd" placeholder="Confirm Password" />
                            </div> <input type="button" name="next" class="next action-button" value="Next" />
                        </fieldset>
                        <fieldset>
                            <div class="form-card">
                                <div class="row">
                                    <div class="col-7">
                                        <h2 class="fs-title">Personal Information:</h2>
                                    </div>
                                    <div class="col-5">
                                        <h2 class="steps">Step 2 - 4</h2>
                                    </div>
                                </div> <label class="fieldlabels">First Name: *</label> <input type="text" name="fname" placeholder="First Name" /> <label class="fieldlabels">Last Name: *</label> <input type="text" name="lname" placeholder="Last Name" /> <label class="fieldlabels">Contact No.: *</label> <input type="text" name="phno" placeholder="Contact No." /> <label class="fieldlabels">Alternate Contact No.: *</label> <input type="text" name="phno_2" placeholder="Alternate Contact No." />
                            </div> <input type="button" name="next" class="next action-button" value="Next" /> <input type="button" name="previous" class="previous action-button-previous" value="Previous" />
                        </fieldset>
                        <fieldset>
                            <div class="form-card">
                                <div class="row">
                                    <div class="col-7">
                                        <h2 class="fs-title">Image Upload:</h2>
                                    </div>
                                    <div class="col-5">
                                        <h2 class="steps">Step 3 - 4</h2>
                                    </div>
                                </div> <label class="fieldlabels">Upload Your Photo:</label> <input type="file" name="pic" accept="image/*"> <label class="fieldlabels">Upload Signature Photo:</label> <input type="file" name="pic" accept="image/*">
                            </div> <input type="button" name="next" class="next action-button" value="Submit" /> <input type="button" name="previous" class="previous action-button-previous" value="Previous" />
                        </fieldset>
                        <fieldset>
                            <div class="form-card">
                                <div class="row">
                                    <div class="col-7">
                                        <h2 class="fs-title">Finish:</h2>
                                    </div>
                                    <div class="col-5">
                                        <h2 class="steps">Step 4 - 4</h2>
                                    </div>
                                </div> <br><br>
                                <h2 class="purple-text text-center"><strong>SUCCESS !</strong></h2> <br>
                                <div class="row justify-content-center">
                                    <div class="col-3"> <img src="https://i.imgur.com/GwStPmg.png" class="fit-image"> </div>
                                </div> <br><br>
                                <div class="row justify-content-center">
                                    <div class="col-7 text-center">
                                        <h5 class="purple-text text-center">You Have Successfully Signed Up</h5>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </form>
                </div>
            
        </div>
    </div>

@section Scripts{

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="~/js/Steps.js"></script>

    <script>



        $("#btnsubmit").click(function () {
            if (registerForm.valid()) {
                var data = new FormData();
                var file = $("#picture")[0].files[0];
                data.append('image', file);
                data.append('Email', $("#email").val());
                data.append('State', $("#state").val());
                data.append('MaritalStatus', $("#maritalstatus").val());
                data.append('Occupation', $("#occupation").val());
                data.append('NatureOfWork', $("#business").val());
                data.append('WorshipCenter', $("#worship").val());
                data.append('Organisation', $("#org").val());
                data.append('Society', $("#society").val());
                data.append('BCC', $("#bcc").val());
                data.append('MCardNumber', $("#card").val());
                data.append('Suggestion', $("#suggestion").val());
                data.append('PhoneNumber', $("#phone").val());
                data.append('Surname', $("#surname").val());
                data.append('OtherNames', $("#othname").val());
                data.append('Password', $("#cpassword").val());
                data.append('Sex', $("#gender").val());
                data.append('DateOfBirth', $("#dob").val());
                data.append('Address', $("#address").val());

                $.ajax({
                    url: "/accounts/register",
                    type: "POST",
                    data: data,
                    contentType: false,
                    processData: false,
                    success: function (res) {
                        if (res.status) {
                            clearForm();
                            swal('Registration Successful!', res.data, 'success');
                            clearForm();
                            return;
                        }
                        swal('Error', res.data, 'error');
                    },
                    error: function (err) {
                        swal('Error', "Oops! An error occured while processing your request.", 'error');
                    }
                })

            }


        })


        function clearForm() {
            $("#email").val('');
            $("#phone").val('');
            $("#state").val('');
            $("#surname").val('');
            $("#org").val('');
            $("#suggestion").val('');
            $("#bcc").val('');
            $("#society").val('');
            $("#business").val('');
            $("#worship").val('');
            $("#occupation").val('');
            $("#card").val('');
            $("#maritalstatus").val('');
            $("#othname").val('');
            $("#cpassword").val('');
            $("#password").val('');
            $("#gender").val('');
            $("#dob").val('');
            $("#address").val('');
            $("#picture").val('');

        }



    </script>
}
